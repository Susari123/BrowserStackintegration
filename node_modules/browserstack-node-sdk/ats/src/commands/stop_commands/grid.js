const a21_0x23db97=a21_0x4848;function a21_0x4848(_0x2ee31c,_0xc30d3f){const _0x20cabd=a21_0x20ca();return a21_0x4848=function(_0x484863,_0x359ee5){_0x484863=_0x484863-0x1bf;let _0x545ced=_0x20cabd[_0x484863];return _0x545ced;},a21_0x4848(_0x2ee31c,_0xc30d3f);}(function(_0x44b525,_0x3d946e){const _0x5ad071=a21_0x4848,_0x15672e=_0x44b525();while(!![]){try{const _0x5821d9=-parseInt(_0x5ad071(0x1f8))/0x1*(parseInt(_0x5ad071(0x200))/0x2)+-parseInt(_0x5ad071(0x21a))/0x3+-parseInt(_0x5ad071(0x203))/0x4+-parseInt(_0x5ad071(0x1cf))/0x5+parseInt(_0x5ad071(0x1d4))/0x6*(parseInt(_0x5ad071(0x1e6))/0x7)+-parseInt(_0x5ad071(0x218))/0x8*(parseInt(_0x5ad071(0x1fd))/0x9)+parseInt(_0x5ad071(0x1e4))/0xa;if(_0x5821d9===_0x3d946e)break;else _0x15672e['push'](_0x15672e['shift']());}catch(_0x13f3f4){_0x15672e['push'](_0x15672e['shift']());}}}(a21_0x20ca,0xa402f));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x23db97(0x1c2)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x23db97(0x211)),{logger}=require('../../config/logger'),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require('../../utils/gridComponents'),{sendInstrumentationEvent}=require(a21_0x23db97(0x210)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require(a21_0x23db97(0x1c8)),{getCloudProviderObject}=require('../../cloudproviders/utils');exports['command']=a21_0x23db97(0x214),exports['desc']=a21_0x23db97(0x1d3),exports['builder']=function(_0x4eb40d){const _0x305651=a21_0x23db97,_0x3f08d6={};_0x3f08d6[_0x305651(0x1dd)]=_0x305651(0x20c),_0x3f08d6[_0x305651(0x1d9)]=_0x305651(0x206),_0x3f08d6[_0x305651(0x1fe)]=_0x305651(0x1f1),_0x3f08d6['wadNI']=_0x305651(0x1e3),_0x3f08d6['dyTRv']=_0x305651(0x1d5);const _0x90d5a=_0x3f08d6,_0x2fc59c={};_0x2fc59c[_0x305651(0x212)]=_0x90d5a['WiIJV'],_0x2fc59c[_0x305651(0x1f6)]=_0x90d5a['qAxdQ'];const _0xec4e4c={};_0xec4e4c[_0x305651(0x212)]=_0x90d5a[_0x305651(0x1fe)],_0xec4e4c['type']=_0x90d5a[_0x305651(0x1ed)],_0xec4e4c[_0x305651(0x1f5)]=![];const _0x463fc7={};return _0x463fc7[_0x305651(0x20e)]=_0x2fc59c,_0x463fc7[_0x305651(0x1d0)]=_0xec4e4c,_0x4eb40d['usage'](HELP_HEADER_MESSAGE[_0x305651(0x1f4)])[_0x305651(0x1c4)](HELP_FOOTER_MESSAGE)[_0x305651(0x202)](_0x463fc7)[_0x305651(0x1d5)](_0x90d5a['dyTRv'])[_0x305651(0x217)];},exports[a21_0x23db97(0x1ea)]=async function(_0x1d505b){const _0x50dd48=a21_0x23db97,_0x20d008={'cleil':_0x50dd48(0x1eb),'LcsiE':function(_0x256183){return _0x256183();},'BUzfA':_0x50dd48(0x1ca),'rjTgE':function(_0x587082,_0x5d199a,_0x26f2cf,_0x37dcca,_0x4a9069,_0x5b785f,_0x3fa57d){return _0x587082(_0x5d199a,_0x26f2cf,_0x37dcca,_0x4a9069,_0x5b785f,_0x3fa57d);},'Tofzv':_0x50dd48(0x213),'jWXpa':_0x50dd48(0x215),'XHRiF':_0x50dd48(0x1f0),'IyDVQ':_0x50dd48(0x20a),'wRFmi':_0x50dd48(0x1c0),'pnNwv':function(_0x57a84c,_0x33cc3c,_0x56ce7d,_0x319e5b){return _0x57a84c(_0x33cc3c,_0x56ce7d,_0x319e5b);},'Yuirf':function(_0x25f539,_0x4928a5,_0x165f4f){return _0x25f539(_0x4928a5,_0x165f4f);},'JQkLB':function(_0x57e8a9,_0x1e5b71,_0x1f94aa){return _0x57e8a9(_0x1e5b71,_0x1f94aa);},'aqOfl':_0x50dd48(0x1ec),'SnwXg':function(_0x3a93a6,_0x1ff666){return _0x3a93a6===_0x1ff666;},'iZQbu':_0x50dd48(0x1bf),'klEQz':function(_0x18ee2d,_0x128ccd,_0x317ffa,_0x59eb26,_0x3144a2,_0x4ccbe7,_0x34efdb){return _0x18ee2d(_0x128ccd,_0x317ffa,_0x59eb26,_0x3144a2,_0x4ccbe7,_0x34efdb);},'rKhMs':_0x50dd48(0x1cd),'hPoGs':function(_0x5c71bb,_0x12d852,_0x275d64,_0x444056,_0x295c73,_0x32f28d,_0x126128){return _0x5c71bb(_0x12d852,_0x275d64,_0x444056,_0x295c73,_0x32f28d,_0x126128);},'MywhR':_0x50dd48(0x20b),'qlFBc':function(_0x17d810,_0x144d10,_0xb584f3,_0x407ba2,_0x2d2807,_0x162e0a,_0x2b5346){return _0x17d810(_0x144d10,_0xb584f3,_0x407ba2,_0x2d2807,_0x162e0a,_0x2b5346);},'pWkNn':_0x50dd48(0x1e9)};let _0x1153b4;try{!_0x1d505b[_0x50dd48(0x1e5)]&&(logger[_0x50dd48(0x1f7)](_0x20d008['cleil']),process[_0x50dd48(0x1ef)](0x1));!fs[_0x50dd48(0x1d8)](_0x20d008[_0x50dd48(0x1df)](getCredentialsPath))&&(logger[_0x50dd48(0x1f7)](_0x20d008[_0x50dd48(0x201)]),await _0x20d008[_0x50dd48(0x1e7)](sendInstrumentationEvent,_0x1d505b,_0x20d008[_0x50dd48(0x1f3)],messageTypes[_0x50dd48(0x1d6)],_0x20d008[_0x50dd48(0x1fa)],null,_0x1d505b),process[_0x50dd48(0x1ef)](0x1));logger[_0x50dd48(0x219)](_0x50dd48(0x1f9)+_0x1d505b[_0x50dd48(0x1e5)]),await _0x20d008[_0x50dd48(0x1e7)](sendInstrumentationEvent,_0x1d505b,_0x20d008['Tofzv'],messageTypes[_0x50dd48(0x1c6)],null,null,_0x1d505b);const _0x3eb1aa=JSON['parse'](fs[_0x50dd48(0x1c7)](_0x20d008[_0x50dd48(0x1df)](getCredentialsPath)));global_registry['bstackUsername']=_0x3eb1aa['Browserstack'][_0x50dd48(0x1c1)],global_registry['bstackAccesskey']=_0x3eb1aa[_0x50dd48(0x1e8)][_0x50dd48(0x1c5)];const _0x3090a6=WS_ENDPOINT[_0x50dd48(0x1db)](_0x20d008[_0x50dd48(0x20f)],_0x3eb1aa[_0x50dd48(0x1e8)][_0x50dd48(0x1c1)])[_0x50dd48(0x1db)](_0x20d008['IyDVQ'],_0x3eb1aa[_0x50dd48(0x1e8)]['password']),_0x13a6aa={};_0x13a6aa[_0x50dd48(0x1d2)]=ws,_0x13a6aa[_0x50dd48(0x1de)]=0x36ee80,_0x1153b4=new ReconnectingWebSocket(_0x3090a6,[],_0x13a6aa),logger[_0x50dd48(0x1da)](_0x20d008[_0x50dd48(0x1f2)]),webSocketUtils['addListeners'](_0x1153b4,_0x1d505b[_0x50dd48(0x1ff)],_0x1d505b[_0x50dd48(0x1c5)]);const [_0x1408c7,_0xf8a59]=await _0x20d008[_0x50dd48(0x204)](getGridDetails,_0x3eb1aa['Browserstack'][_0x50dd48(0x1c1)],_0x3eb1aa[_0x50dd48(0x1e8)]['password'],_0x1d505b[_0x50dd48(0x1e5)]);if(_0xf8a59){const _0x2c6ebb=_0xf8a59[_0x50dd48(0x219)];global_registry[_0x50dd48(0x20d)]=_0x2c6ebb['cloudProvider'],global_registry[_0x50dd48(0x1fb)]=_0x2c6ebb['region'],global_registry[_0x50dd48(0x1cc)]=_0x2c6ebb[_0x50dd48(0x1cc)];const _0x3ea0d7=await _0x20d008[_0x50dd48(0x1e7)](getCloudProviderObject,_0x2c6ebb[_0x50dd48(0x20d)],_0x2c6ebb[_0x50dd48(0x1cc)],_0x2c6ebb['name'],_0x1153b4,webSocketUtils,_0x1d505b),[_0x41d570,_0x508343,_0x1862c7,_0x3dad1c,_0x3d4cd2,_0x3c85f9]=await _0x20d008[_0x50dd48(0x1fc)](createK8sClient,_0x3ea0d7,_0x1d505b[_0x50dd48(0x1e0)]);await _0x20d008[_0x50dd48(0x1e2)](scaleDownHubDeployment,_0x508343,_0x2c6ebb[_0x50dd48(0x1c3)]),logger['info'](_0x20d008['aqOfl']),process[_0x50dd48(0x1ef)](0x0);}_0x20d008[_0x50dd48(0x1ee)](_0x1408c7[_0x50dd48(0x1d7)],0x191)&&(logger[_0x50dd48(0x1f7)](_0x20d008[_0x50dd48(0x1ce)]),await _0x20d008[_0x50dd48(0x209)](sendInstrumentationEvent,_0x1d505b,_0x20d008[_0x50dd48(0x1f3)],messageTypes['ERROR'],_0x20d008[_0x50dd48(0x208)],null,_0x1d505b),process[_0x50dd48(0x1ef)](0x1)),_0x20d008[_0x50dd48(0x1ee)](_0x1408c7[_0x50dd48(0x1d7)],0x190)&&(logger[_0x50dd48(0x1f7)](JSON[_0x50dd48(0x1dc)](_0x1408c7[_0x50dd48(0x1c9)])['message']),await _0x20d008[_0x50dd48(0x1e1)](sendInstrumentationEvent,_0x1d505b,_0x20d008[_0x50dd48(0x1f3)],messageTypes[_0x50dd48(0x1d6)],_0x20d008['MywhR'],null,_0x1d505b),process[_0x50dd48(0x1ef)](0x1)),logger[_0x50dd48(0x1f7)](_0x50dd48(0x205)+JSON['stringify'](_0x1408c7)),await _0x20d008[_0x50dd48(0x216)](sendInstrumentationEvent,_0x1d505b,_0x20d008[_0x50dd48(0x1f3)],messageTypes[_0x50dd48(0x1d6)],_0x20d008[_0x50dd48(0x207)],_0x1408c7,_0x1d505b),process[_0x50dd48(0x1ef)](0x1);}catch(_0x3200b0){const _0x21a714=_0x50dd48(0x1cb)+_0x3200b0+'\x20\x0a'+JSON['stringify'](_0x3200b0[_0x50dd48(0x1d1)])+'\x20';logger[_0x50dd48(0x1f7)](_0x21a714),process[_0x50dd48(0x1ef)](0x1);}};function a21_0x20ca(){const _0x477953=['connectionTimeout','LcsiE','skipTlsCertVerify','hPoGs','JQkLB','boolean','17207800UJQetw','gridId','10101mZxQhx','rjTgE','Browserstack','server-error','handler','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','Grid\x20stoppped.','wadNI','SnwXg','exit','<UsernamePlaceholder>','Skip\x20insecure\x20cert\x20verification.','wRFmi','Tofzv','stop','default','type','error','9053SdRsvN','Stopping\x20grid\x20','jWXpa','clusterRegion','Yuirf','586035yMMvAU','WNRVr','user','6admJXx','BUzfA','options','931636RkTGDI','pnNwv','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','string','pWkNn','rKhMs','klEQz','<PasswordPlaceholder>','invalid-grid-id','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','cloudProvider','grid-id','XHRiF','../../utils/instrumentationUtils','../../config/constants','description','stop-grid-called','grid','init-not-called','qlFBc','argv','144YqLhpu','info','856731FiskiQ','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','Adding\x20Websocket\x20listeners','username','reconnecting-websocket','name','epilogue','password','INFO','readFileSync','../../utils/createk8sClient','body','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','clusterName','unauthorised','iZQbu','2738615vdvpWZ','skip-tls-cert-verify','stack','WebSocket','Stop\x20a\x20running\x20Automation\x20grid.','5058oNWdcr','help','ERROR','statusCode','existsSync','qAxdQ','debug','replace','parse','WiIJV'];a21_0x20ca=function(){return _0x477953;};return a21_0x20ca();}